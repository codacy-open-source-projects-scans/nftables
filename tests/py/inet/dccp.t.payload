# dccp sport 21-35
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range eq reg 1 0x0015 0x0023 ]

# dccp sport != 21-35
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range neq reg 1 0x0015 0x0023 ]

# dccp sport {23, 24, 25}
__set%d test-inet 3
__set%d test-inet 0
	element 0017	element 0018	element 0019
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# dccp sport != {23, 24, 25}
__set%d test-inet 3
__set%d test-inet 0
	element 0017	element 0018	element 0019
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# dccp sport 20-50
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 0 => reg 1 ]
  [ range eq reg 1 0x0014 0x0032 ]

# dccp dport {23, 24, 25}
__set%d test-ip4 3
__set%d test-ip4 0
	element 0017	element 0018	element 0019
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# dccp dport != {23, 24, 25}
__set%d test-ip4 3
__set%d test-ip4 0
	element 0017	element 0018	element 0019
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# dccp type {request, response, data, ack, dataack, closereq, close, reset, sync, syncack}
__set%d test-inet 3
__set%d test-inet 0
	element 00	element 02	element 04	element 06	element 08	element 0a	element 0c	element 0e	element 10	element 12
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 1b @ transport header + 8 => reg 1 ]
  [ bitwise reg 1 = ( reg 1 & 0x1e ) ^ 0x00 ]
  [ lookup reg 1 set __set%d ]

# dccp type != {request, response, data, ack, dataack, closereq, close, reset, sync, syncack}
__set%d test-inet 3
__set%d test-inet 0
	element 00	element 02	element 04	element 06	element 08	element 0a	element 0c	element 0e	element 10	element 12
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 1b @ transport header + 8 => reg 1 ]
  [ bitwise reg 1 = ( reg 1 & 0x1e ) ^ 0x00 ]
  [ lookup reg 1 set __set%d 0x1 ]

# dccp type request
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 1b @ transport header + 8 => reg 1 ]
  [ bitwise reg 1 = ( reg 1 & 0x1e ) ^ 0x00 ]
  [ cmp eq reg 1 0x00 ]

# dccp type != request
inet test-inet input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x21 ]
  [ payload load 1b @ transport header + 8 => reg 1 ]
  [ bitwise reg 1 = ( reg 1 & 0x1e ) ^ 0x00 ]
  [ cmp neq reg 1 0x00 ]
