# iifname "eth0" tcp dport 81 snat ip to 192.168.3.2
inet test-inet postrouting
  [ meta load iifname => reg 1 ]
  [ cmp eq reg 1 0x65746830 0x00000000 0x00000000 0x00000000 ]
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ cmp eq reg 1 0x0051 ]
  [ immediate reg 1 0xc0a80302 ]
  [ nat snat ip addr_min reg 1 ]

# iifname "eth0" tcp dport 81 ip saddr 10.1.1.1 snat to 192.168.3.2
inet test-inet postrouting
  [ meta load iifname => reg 1 ]
  [ cmp eq reg 1 0x65746830 0x00000000 0x00000000 0x00000000 ]
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ cmp eq reg 1 0x0051 ]
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ cmp eq reg 1 0x0a010101 ]
  [ immediate reg 1 0xc0a80302 ]
  [ nat snat ip addr_min reg 1 ]

# iifname "eth0" tcp dport 81 snat ip6 to dead::beef
inet test-inet postrouting
  [ meta load iifname => reg 1 ]
  [ cmp eq reg 1 0x65746830 0x00000000 0x00000000 0x00000000 ]
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ cmp eq reg 1 0x0051 ]
  [ immediate reg 1 0xdead0000 0x00000000 0x00000000 0x0000beef ]
  [ nat snat ip6 addr_min reg 1 ]

# iifname "foo" masquerade random
inet test-inet postrouting
  [ meta load iifname => reg 1 ]
  [ cmp eq reg 1 0x666f6f00 0x00000000 0x00000000 0x00000000 ]
  [ masq flags 0x4 ]
