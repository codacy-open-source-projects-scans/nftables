# mh nexthdr 1
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp eq reg 1 0x01 ]

# mh nexthdr != 1
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp neq reg 1 0x01 ]

# mh nexthdr { udplite, ipcomp, udp, ah, sctp, esp, dccp, tcp, ipv6-icmp }
__set%d test-inet 3
__set%d test-inet 0
	element 88	element 6c	element 11	element 33	element 84	element 32	element 21	element 06	element 3a
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh nexthdr != { udplite, ipcomp, udp, ah, sctp, esp, dccp, tcp, ipv6-icmp }
__set%d test-inet 3
__set%d test-inet 0
	element 88	element 6c	element 11	element 33	element 84	element 32	element 21	element 06	element 3a
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# mh nexthdr icmp
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp eq reg 1 0x01 ]

# mh nexthdr != icmp
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp neq reg 1 0x01 ]

# mh nexthdr 22
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# mh nexthdr != 233
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ cmp neq reg 1 0xe9 ]

# mh nexthdr 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ range eq reg 1 0x21 0x2d ]

# mh nexthdr != 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ range neq reg 1 0x21 0x2d ]

# mh nexthdr { 33, 55, 67, 88 }
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh nexthdr != { 33, 55, 67, 88 }
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# mh hdrlength 22
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# mh hdrlength != 233
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ cmp neq reg 1 0xe9 ]

# mh hdrlength 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ range eq reg 1 0x21 0x2d ]

# mh hdrlength != 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ range neq reg 1 0x21 0x2d ]

# mh hdrlength { 33, 55, 67, 88 }
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh hdrlength != { 33, 55, 67, 88 }
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 1 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# mh type {binding-refresh-request, home-test-init, careof-test-init, home-test, careof-test, binding-update, binding-acknowledgement, binding-error, fast-binding-update, fast-binding-acknowledgement, fast-binding-advertisement, experimental-mobility-header, home-agent-switch-message}
__set%d test-inet 3
__set%d test-inet 0
	element 00	element 01	element 02	element 03	element 04	element 05	element 06	element 07	element 08	element 09	element 0a	element 0b	element 0c
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 2 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh type home-agent-switch-message
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 2 => reg 1 ]
  [ cmp eq reg 1 0x0c ]

# mh type != home-agent-switch-message
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 2 => reg 1 ]
  [ cmp neq reg 1 0x0c ]

# mh reserved 22
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# mh reserved != 233
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ cmp neq reg 1 0xe9 ]

# mh reserved 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ range eq reg 1 0x21 0x2d ]

# mh reserved != 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ range neq reg 1 0x21 0x2d ]

# mh reserved { 33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh reserved != { 33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 135 + 3 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# mh checksum 22
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ cmp eq reg 1 0x0016 ]

# mh checksum != 233
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ cmp neq reg 1 0x00e9 ]

# mh checksum 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ range eq reg 1 0x0021 0x002d ]

# mh checksum != 33-45
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ range neq reg 1 0x0021 0x002d ]

# mh checksum { 33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 0021	element 0037	element 0043	element 0058
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# mh checksum != { 33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 0021	element 0037	element 0043	element 0058
inet test-inet input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 2b @ 135 + 4 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]
