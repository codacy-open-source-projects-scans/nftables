# hbh hdrlength 22
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# hbh hdrlength != 233
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ cmp neq reg 1 0xe9 ]

# hbh hdrlength 33-45
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ range eq reg 1 0x21 0x2d ]

# hbh hdrlength != 33-45
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ range neq reg 1 0x21 0x2d ]

# hbh hdrlength {33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# hbh hdrlength != {33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 1 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# hbh nexthdr {esp, ah, comp, udp, udplite, tcp, dccp, sctp, icmpv6}
__set%d test-inet 3
__set%d test-inet 0
	element 32	element 33	element 6c	element 11	element 88	element 06	element 21	element 84	element 3a
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# hbh nexthdr != {esp, ah, comp, udp, udplite, tcp, dccp, sctp, icmpv6}
__set%d test-inet 3
__set%d test-inet 0
	element 32	element 33	element 6c	element 11	element 88	element 06	element 21	element 84	element 3a
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# hbh nexthdr 22
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# hbh nexthdr != 233
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ cmp neq reg 1 0xe9 ]

# hbh nexthdr 33-45
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ range eq reg 1 0x21 0x2d ]

# hbh nexthdr != 33-45
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ range neq reg 1 0x21 0x2d ]

# hbh nexthdr {33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# hbh nexthdr != {33, 55, 67, 88}
__set%d test-inet 3
__set%d test-inet 0
	element 21	element 37	element 43	element 58
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# hbh nexthdr ip
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ cmp eq reg 1 0x00 ]

# hbh nexthdr != ip
inet test-inet filter-input
  [ meta load nfproto => reg 1 ]
  [ cmp eq reg 1 0x0a ]
  [ exthdr load ipv6 1b @ 0 + 0 => reg 1 ]
  [ cmp neq reg 1 0x00 ]
