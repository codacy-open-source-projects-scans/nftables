# ip6 saddr vmap { abcd::3 : accept }
__map%d test-ip6 b
__map%d test-ip6 0
	element abcd0000 00000000 00000000 00000003 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234:1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00001234 12341234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234:1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 12341234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234::1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00001234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234::1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12340000 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234::1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 00001234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12340000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234:1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234:1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 12340000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 12341234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00001234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234::1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00000000 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234::1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12340000 00001234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 00000000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12340000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 00001234 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00000000 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234::1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00000000 00001234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12340000 00000000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 00000000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12340000 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 00000000 12341234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00000000 00001234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00000000 00000000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12340000 00000000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 00000000 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 00000000 00001234 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00000000 00000000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00000000 00000000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12340000 00000000 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234:1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 00000000 00000000 12341234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00000000 00000000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 00000000 00000000 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::1234 : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 00000000 00000000 00000000 00001234 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { 1234:: : accept}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12340000 00000000 00000000 00000000 : accept
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap { ::/64 : accept}
__map%d test-ip6 f
__map%d test-ip6 0
	element 00000000 00000000 00000000 00000000 : accept	element 00000000 00000001 00000000 00000000 flags 1
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap {1234:1234:1234:1234:1234:1234:aaaa:: : accept, ::aaaa : drop}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 aaaa0000 : accept	element 00000000 00000000 00000000 0000aaaa : drop
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap {1234:1234:1234:1234:1234:1234:aaaa:::accept, ::bbbb : drop}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 aaaa0000 : accept	element 00000000 00000000 00000000 0000bbbb : drop
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap {1234:1234:1234:1234:1234:1234:aaaa:::accept,::cccc : drop}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 aaaa0000 : accept	element 00000000 00000000 00000000 0000cccc : drop
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]

# ip6 saddr vmap {1234:1234:1234:1234:1234:1234:aaaa:::accept,::dddd: drop}
__map%d test-ip6 b
__map%d test-ip6 0
	element 12341234 12341234 12341234 aaaa0000 : accept	element 00000000 00000000 00000000 0000dddd : drop
ip6 test-ip6 input
  [ payload load 16b @ network header + 8 => reg 1 ]
  [ lookup reg 1 set __map%d dreg 0 ]
