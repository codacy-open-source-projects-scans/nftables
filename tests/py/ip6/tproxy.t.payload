# meta l4proto 6 tproxy to [2001:db8::1]
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ immediate reg 1 0x20010db8 0x00000000 0x00000000 0x00000001 ]
  [ tproxy ip6 addr reg 1 ]

# meta l4proto 17 tproxy to [2001:db8::1]:50080
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x11 ]
  [ immediate reg 1 0x20010db8 0x00000000 0x00000000 0x00000001 ]
  [ immediate reg 2 0xc3a0 ]
  [ tproxy ip6 addr reg 1 port reg 2 ]

# meta l4proto 6 tproxy to :50080
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ immediate reg 1 0xc3a0 ]
  [ tproxy ip6 port reg 1 ]

# meta l4proto 6 tproxy ip6 to [2001:db8::1]
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ immediate reg 1 0x20010db8 0x00000000 0x00000000 0x00000001 ]
  [ tproxy ip6 addr reg 1 ]

# meta l4proto 17 tproxy ip6 to [2001:db8::1]:50080
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x11 ]
  [ immediate reg 1 0x20010db8 0x00000000 0x00000000 0x00000001 ]
  [ immediate reg 2 0xc3a0 ]
  [ tproxy ip6 addr reg 1 port reg 2 ]

# meta l4proto 6 tproxy ip6 to :50080
ip6 x y 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ immediate reg 1 0xc3a0 ]
  [ tproxy ip6 port reg 1 ]
