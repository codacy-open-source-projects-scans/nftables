# ip saddr 192.168.1.3 counter name "cnt2"
ip test-ip4 input
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ cmp eq reg 1 0xc0a80103 ]
  [ objref type 1 name cnt2 ]

# counter name tcp dport map {443 : "cnt1", 80 : "cnt2", 22 : "cnt1"}
__objmap%d test-ip4 43
__objmap%d test-ip4 0
	element 01bb : cnt1	element 0050 : cnt2	element 0016 : cnt1
ip test-ip4 input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ objref sreg 1 set __objmap%d ]

# ip saddr 192.168.1.3 quota name "qt1"
ip test-ip4 input
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ cmp eq reg 1 0xc0a80103 ]
  [ objref type 2 name qt1 ]

# quota name tcp dport map {443 : "qt1", 80 : "qt2", 22 : "qt1"}
__objmap%d test-ip4 43
__objmap%d test-ip4 0
	element 01bb : qt1	element 0050 : qt2	element 0016 : qt1
ip test-ip4 input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ objref sreg 1 set __objmap%d ]

# ct helper set "cthelp1"
ip test-ip4 input
  [ objref type 3 name cthelp1 ]

# ct helper set tcp dport map {21 : "cthelp1", 2121 : "cthelp1" }
__objmap%d test-ip4 43
__objmap%d test-ip4 0
	element 0015 : cthelp1	element 0849 : cthelp1
ip test-ip4 input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ objref sreg 1 set __objmap%d ]

# ip saddr 192.168.1.3 limit name "lim1"
ip test-ip4 input
  [ payload load 4b @ network header + 12 => reg 1 ]
  [ cmp eq reg 1 0xc0a80103 ]
  [ objref type 4 name lim1 ]

# limit name tcp dport map {443 : "lim1", 80 : "lim2", 22 : "lim1"}
__objmap%d test-ip4 43 size 3
__objmap%d test-ip4 0
	element 01bb : lim1	element 0050 : lim2	element 0016 : lim1
ip test-ip4 input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ objref sreg 1 set __objmap%d ]

# ct timeout set "cttime1"
ip test-ip4 input
  [ objref type 7 name cttime1 ]

# ct expectation set "ctexpect1"
ip test-ip4 input
  [ objref type 9 name ctexpect1 ]

# synproxy name tcp dport map {443 : "synproxy1", 80 : "synproxy2"}
__objmap%d test-ip4 43 size 2
__objmap%d test-ip4 0
	element 01bb : synproxy1	element 0050 : synproxy2
ip test-ip4 input
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x06 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ objref sreg 1 set __objmap%d ]
