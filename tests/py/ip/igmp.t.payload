# igmp type membership-query
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ cmp eq reg 1 0x11 ]

# igmp type membership-report-v1
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ cmp eq reg 1 0x12 ]

# igmp type membership-report-v2
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ cmp eq reg 1 0x16 ]

# igmp type membership-report-v3
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ cmp eq reg 1 0x22 ]

# igmp type leave-group
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ cmp eq reg 1 0x17 ]

# igmp checksum 12343
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ cmp eq reg 1 0x3037 ]

# igmp checksum != 12343
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ cmp neq reg 1 0x3037 ]

# igmp checksum 11-343
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range eq reg 1 0x000b 0x0157 ]

# igmp checksum != 11-343
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ range neq reg 1 0x000b 0x0157 ]

# igmp checksum { 1111, 222, 343}
__set%d test-ip4 3 size 3
__set%d test-ip4 0
	element 0457	element 00de	element 0157
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# igmp checksum != { 1111, 222, 343}
__set%d test-ip4 3 size 3
__set%d test-ip4 0
	element 0457	element 00de	element 0157
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 2b @ transport header + 2 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# igmp type { membership-report-v1, membership-report-v2, membership-report-v3}
__set%d test-ip4 3 size 3
__set%d test-ip4 0
	element 12	element 16	element 22
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __set%d ]

# igmp type != { membership-report-v1, membership-report-v2, membership-report-v3}
__set%d test-ip4 3 size 3
__set%d test-ip4 0
	element 12	element 16	element 22
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 0 => reg 1 ]
  [ lookup reg 1 set __set%d 0x1 ]

# igmp mrt 10
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 1 => reg 1 ]
  [ cmp eq reg 1 0x0a ]

# igmp mrt != 10
ip test-ip4 input 
  [ meta load l4proto => reg 1 ]
  [ cmp eq reg 1 0x02 ]
  [ payload load 1b @ transport header + 1 => reg 1 ]
  [ cmp neq reg 1 0x0a ]
